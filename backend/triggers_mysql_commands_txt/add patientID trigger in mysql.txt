DELIMITER $$

CREATE TRIGGER before_insert_patient
BEFORE INSERT ON patient
FOR EACH ROW
BEGIN
  DECLARE lastID INT;
  DECLARE newID VARCHAR(20);

  -- Get the numeric part of the latest patientID
  SELECT
    IFNULL(MAX(CAST(SUBSTRING(patientID, 8) AS UNSIGNED)), 0)
  INTO lastID
  FROM patient;

  -- Format new patientID with leading zeros
  SET newID = CONCAT('PATIENT', LPAD(lastID + 1, 4, '0'));

  -- Assign to the new row
  SET NEW.patientID = newID;
END$$

DELIMITER ;


-- SHOW TRIGGERS;

-- DROP TRIGGER IF EXISTS before_insert_patient; dont execute this code this will delete all data